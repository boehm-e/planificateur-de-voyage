{"version":3,"sources":["groups.js"],"names":["groupsRoutes","express","Router","notImplemented","req","res","end","route","get","passport","authenticate","session","authCtrl","authorizeAdmin","groupsCtrl","getAll","post","utils","validateReqBody","joiSchema","create","addGroupToReq","authorizeFnList","group","user","id","members","map","u","includes","getById","inviteUsers","deleteGroup","put","params","user_id","respondToInvitation"],"mappings":";;;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AAEA,IAAMA,YAAY,GAAGC,oBAAQC,MAAR,EAArB;;AAEA,IAAMC,cAAc,GAAG,SAAjBA,cAAiB,CAACC,GAAD,EAAMC,GAAN;AAAA,SAAcA,GAAG,CAACC,GAAJ,CAAQ,qBAAR,CAAd;AAAA,CAAvB;;AAEAN,YAAY,CAACO,KAAb,CAAmB,GAAnB,EACKC,GADL,CAEQC,qBAASC,YAAT,CAAsB,KAAtB,EAA6B;AAAEC,EAAAA,OAAO,EAAE;AAAX,CAA7B,CAFR,EAGQC,iBAASC,cAHjB,EAIQC,mBAAWC,MAJnB,EAMKC,IANL,CAOQP,qBAASC,YAAT,CAAsB,KAAtB,EAA6B;AAAEC,EAAAA,OAAO,EAAE;AAAX,CAA7B,CAPR,EAQQM,kBAAMC,eAAN,CAAsBJ,mBAAWK,SAAjC,CARR,EASQL,mBAAWM,MATnB;AAYApB,YAAY,CAACO,KAAb,CAAmB,MAAnB,EACKC,GADL,CAEQC,qBAASC,YAAT,CAAsB,KAAtB,EAA6B;AAAEC,EAAAA,OAAO,EAAE;AAAX,CAA7B,CAFR,EAGQG,mBAAWO,aAHnB,EAIQT,iBAASU,eAAT,CAAyB,CACrB,UAAAlB,GAAG;AAAA,SAAI,CAACA,GAAG,CAACmB,KAAJ,CAAUC,IAAV,CAAeC,EAAhB,6CAAuBrB,GAAG,CAACmB,KAAJ,CAAUG,OAAV,CAAkBC,GAAlB,CAAsB,UAAAC,CAAC;AAAA,WAAIA,CAAC,CAACH,EAAN;AAAA,GAAvB,CAAvB,GAAyDI,QAAzD,CAAkEzB,GAAG,CAACoB,IAAJ,CAASC,EAA3E,CAAJ;AAAA,CADkB,CAAzB,CAJR,EAOQX,mBAAWgB,OAPnB,EASKd,IATL,CAUQP,qBAASC,YAAT,CAAsB,KAAtB,EAA6B;AAAEC,EAAAA,OAAO,EAAE;AAAX,CAA7B,CAVR,EAWQG,mBAAWO,aAXnB,EAYQT,iBAASU,eAAT,CAAyB,CACrB,UAAAlB,GAAG;AAAA,SAAIA,GAAG,CAACmB,KAAJ,CAAUC,IAAV,CAAeC,EAAf,IAAqBrB,GAAG,CAACoB,IAAJ,CAASC,EAAlC;AAAA,CADkB,CAAzB,CAZR,EAeQX,mBAAWiB,WAfnB,YAkBQtB,qBAASC,YAAT,CAAsB,KAAtB,EAA6B;AAAEC,EAAAA,OAAO,EAAE;AAAX,CAA7B,CAlBR,EAmBQG,mBAAWO,aAnBnB,EAoBQT,iBAASU,eAAT,CAAyB,CACrB,UAAAlB,GAAG;AAAA,SAAIA,GAAG,CAACmB,KAAJ,CAAUC,IAAV,CAAeC,EAAf,IAAqBrB,GAAG,CAACoB,IAAJ,CAASC,EAAlC;AAAA,CADkB,CAAzB,CApBR,EAuBQX,mBAAWkB,WAvBnB;AA0BAhC,YAAY,CAACO,KAAb,CAAmB,eAAnB,EACK0B,GADL,CAEQxB,qBAASC,YAAT,CAAsB,KAAtB,EAA6B;AAAEC,EAAAA,OAAO,EAAE;AAAX,CAA7B,CAFR,EAGQC,iBAASU,eAAT,CAAyB,CACrB,UAAAlB,GAAG;AAAA,SAAIA,GAAG,CAAC8B,MAAJ,CAAWC,OAAX,IAAsB/B,GAAG,CAACoB,IAAJ,CAASC,EAAnC;AAAA,CADkB,CAAzB,CAHR,EAMQX,mBAAWsB,mBANnB,YASQ3B,qBAASC,YAAT,CAAsB,KAAtB,EAA6B;AAAEC,EAAAA,OAAO,EAAE;AAAX,CAA7B,CATR,EAUQR,cAVR;eAaeH,Y","sourceRoot":"/home/erwan/Desktop/ETNA/MOBI/mobi_appli/API/src/routes","sourcesContent":["import express    from 'express';\nimport passport   from 'passport';\nimport utils      from '../helpers/utils';\nimport authCtrl   from '../controllers/auth';\nimport groupsCtrl from '../controllers/groups';\n\nconst groupsRoutes = express.Router();\n\nconst notImplemented = (req, res) => res.end('Not Implemented Yet');\n\ngroupsRoutes.route('/')\n    .get(\n        passport.authenticate('jwt', { session: false }),\n        authCtrl.authorizeAdmin,\n        groupsCtrl.getAll\n    )\n    .post(\n        passport.authenticate('jwt', { session: false }),\n        utils.validateReqBody(groupsCtrl.joiSchema),\n        groupsCtrl.create\n    );\n\ngroupsRoutes.route('/:id')\n    .get(\n        passport.authenticate('jwt', { session: false }),\n        groupsCtrl.addGroupToReq,\n        authCtrl.authorizeFnList([\n            req => [req.group.user.id, ...req.group.members.map(u => u.id)].includes(req.user.id)\n        ]),\n        groupsCtrl.getById\n    )\n    .post(\n        passport.authenticate('jwt', { session: false }),\n        groupsCtrl.addGroupToReq,\n        authCtrl.authorizeFnList([\n            req => req.group.user.id == req.user.id\n        ]),\n        groupsCtrl.inviteUsers\n    )\n    .delete(\n        passport.authenticate('jwt', { session: false }),\n        groupsCtrl.addGroupToReq,\n        authCtrl.authorizeFnList([\n            req => req.group.user.id == req.user.id\n        ]),\n        groupsCtrl.deleteGroup\n    );\n\ngroupsRoutes.route('/:id/:user_id')\n    .put(\n        passport.authenticate('jwt', { session: false }),\n        authCtrl.authorizeFnList([\n            req => req.params.user_id == req.user.id\n        ]),\n        groupsCtrl.respondToInvitation\n    )\n    .delete(\n        passport.authenticate('jwt', { session: false }),\n        notImplemented\n    );\n\nexport default groupsRoutes;\n"]}