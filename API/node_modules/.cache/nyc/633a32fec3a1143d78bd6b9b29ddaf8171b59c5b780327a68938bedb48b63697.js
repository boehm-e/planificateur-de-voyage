"use strict";var cov_ortbyt6o3=function(){var path="/home/erwan/Desktop/ETNA/MOBI/mobi_appli/API/src/controllers/auth.js";var hash="e5380452b9c8bc102c35906cd2632e21b53c8e3c";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/erwan/Desktop/ETNA/MOBI/mobi_appli/API/src/controllers/auth.js",statementMap:{"0":{start:{line:3,column:29},end:{line:3,column:84}},"1":{start:{line:5,column:0},end:{line:7,column:3}},"2":{start:{line:8,column:0},end:{line:8,column:28}},"3":{start:{line:10,column:19},end:{line:10,column:80}},"4":{start:{line:12,column:23},end:{line:12,column:95}},"5":{start:{line:14,column:25},end:{line:14,column:99}},"6":{start:{line:16,column:17},end:{line:16,column:62}},"7":{start:{line:18,column:16},end:{line:18,column:69}},"8":{start:{line:20,column:12},end:{line:20,column:61}},"9":{start:{line:22,column:54},end:{line:22,column:73}},"10":{start:{line:22,column:75},end:{line:22,column:326}},"11":{start:{line:22,column:125},end:{line:22,column:161}},"12":{start:{line:22,column:163},end:{line:22,column:292}},"13":{start:{line:22,column:183},end:{line:22,column:292}},"14":{start:{line:22,column:225},end:{line:22,column:288}},"15":{start:{line:22,column:293},end:{line:22,column:324}},"16":{start:{line:22,column:327},end:{line:22,column:339}},"17":{start:{line:24,column:33},end:{line:24,column:518}},"18":{start:{line:24,column:46},end:{line:24,column:47}},"19":{start:{line:24,column:91},end:{line:24,column:131}},"20":{start:{line:24,column:133},end:{line:24,column:516}},"21":{start:{line:24,column:146},end:{line:24,column:256}},"22":{start:{line:24,column:193},end:{line:24,column:252}},"23":{start:{line:24,column:264},end:{line:24,column:516}},"24":{start:{line:24,column:304},end:{line:24,column:378}},"25":{start:{line:24,column:388},end:{line:24,column:514}},"26":{start:{line:24,column:429},end:{line:24,column:510}},"27":{start:{line:24,column:519},end:{line:24,column:533}},"28":{start:{line:28,column:0},end:{line:85,column:3}},"29":{start:{line:29,column:13},end:{line:80,column:5}},"30":{start:{line:34,column:4},end:{line:79,column:32}},"31":{start:{line:35,column:6},end:{line:78,column:7}},"32":{start:{line:36,column:8},end:{line:77,column:9}},"33":{start:{line:38,column:12},end:{line:38,column:89}},"34":{start:{line:39,column:12},end:{line:39,column:30}},"35":{start:{line:40,column:12},end:{line:40,column:30}},"36":{start:{line:41,column:12},end:{line:41,column:58}},"37":{start:{line:44,column:12},end:{line:44,column:33}},"38":{start:{line:45,column:12},end:{line:45,column:87}},"39":{start:{line:46,column:12},end:{line:46,column:31}},"40":{start:{line:47,column:12},end:{line:47,column:18}},"41":{start:{line:50,column:12},end:{line:50,column:30}},"42":{start:{line:51,column:12},end:{line:51,column:47}},"43":{start:{line:53,column:12},end:{line:56,column:13}},"44":{start:{line:54,column:14},end:{line:54,column:33}},"45":{start:{line:55,column:14},end:{line:55,column:20}},"46":{start:{line:58,column:12},end:{line:61,column:14}},"47":{start:{line:62,column:12},end:{line:62,column:32}},"48":{start:{line:63,column:12},end:{line:63,column:74}},"49":{start:{line:66,column:12},end:{line:66,column:39}},"50":{start:{line:67,column:12},end:{line:67,column:64}},"51":{start:{line:70,column:12},end:{line:72,column:17}},"52":{start:{line:76,column:12},end:{line:76,column:35}},"53":{start:{line:82,column:2},end:{line:84,column:4}},"54":{start:{line:83,column:4},end:{line:83,column:39}},"55":{start:{line:87,column:11},end:{line:90,column:1}},"56":{start:{line:88,column:2},end:{line:88,column:62}},"57":{start:{line:89,column:2},end:{line:89,column:35}},"58":{start:{line:92,column:22},end:{line:196,column:1}},"59":{start:{line:93,column:14},end:{line:96,column:3}},"60":{start:{line:97,column:13},end:{line:97,column:23}},"61":{start:{line:98,column:16},end:{line:98,column:29}},"62":{start:{line:100,column:2},end:{line:195,column:4}},"63":{start:{line:103,column:18},end:{line:189,column:9}},"64":{start:{line:108,column:8},end:{line:188,column:61}},"65":{start:{line:109,column:10},end:{line:187,column:11}},"66":{start:{line:110,column:12},end:{line:186,column:13}},"67":{start:{line:112,column:16},end:{line:112,column:49}},"68":{start:{line:113,column:16},end:{line:113,column:42}},"69":{start:{line:114,column:16},end:{line:114,column:43}},"70":{start:{line:115,column:16},end:{line:115,column:35}},"71":{start:{line:116,column:16},end:{line:116,column:54}},"72":{start:{line:119,column:16},end:{line:122,column:17}},"73":{start:{line:120,column:18},end:{line:120,column:38}},"74":{start:{line:121,column:18},end:{line:121,column:24}},"75":{start:{line:124,column:16},end:{line:124,column:33}},"76":{start:{line:125,column:16},end:{line:125,column:35}},"77":{start:{line:126,column:16},end:{line:126,column:31}},"78":{start:{line:129,column:16},end:{line:132,column:17}},"79":{start:{line:130,column:18},end:{line:130,column:38}},"80":{start:{line:131,column:18},end:{line:131,column:24}},"81":{start:{line:134,column:16},end:{line:134,column:58}},"82":{start:{line:137,column:16},end:{line:137,column:49}},"83":{start:{line:138,column:16},end:{line:138,column:35}},"84":{start:{line:139,column:16},end:{line:139,column:22}},"85":{start:{line:142,column:16},end:{line:142,column:36}},"86":{start:{line:143,column:16},end:{line:143,column:22}},"87":{start:{line:146,column:16},end:{line:146,column:36}},"88":{start:{line:147,column:16},end:{line:147,column:53}},"89":{start:{line:148,column:16},end:{line:148,column:41}},"90":{start:{line:149,column:16},end:{line:149,column:46}},"91":{start:{line:152,column:16},end:{line:152,column:36}},"92":{start:{line:153,column:16},end:{line:153,column:36}},"93":{start:{line:155,column:16},end:{line:157,column:17}},"94":{start:{line:156,column:18},end:{line:156,column:40}},"95":{start:{line:160,column:16},end:{line:160,column:36}},"96":{start:{line:162,column:16},end:{line:165,column:17}},"97":{start:{line:163,column:18},end:{line:163,column:38}},"98":{start:{line:164,column:18},end:{line:164,column:24}},"99":{start:{line:167,column:16},end:{line:167,column:37}},"100":{start:{line:170,column:16},end:{line:170,column:44}},"101":{start:{line:173,column:16},end:{line:173,column:44}},"102":{start:{line:176,column:16},end:{line:179,column:18}},"103":{start:{line:180,column:16},end:{line:180,column:36}},"104":{start:{line:181,column:16},end:{line:181,column:80}},"105":{start:{line:185,column:16},end:{line:185,column:40}},"106":{start:{line:191,column:6},end:{line:193,column:8}},"107":{start:{line:192,column:8},end:{line:192,column:44}},"108":{start:{line:198,column:21},end:{line:203,column:2}},"109":{start:{line:199,column:2},end:{line:199,column:34}},"110":{start:{line:204,column:28},end:{line:211,column:2}},"111":{start:{line:205,column:2},end:{line:205,column:34}},"112":{start:{line:207,column:2},end:{line:207,column:49}},"113":{start:{line:212,column:15},end:{line:218,column:1}},"114":{start:{line:219,column:0},end:{line:219,column:30}}},fnMap:{"0":{name:"ownKeys",decl:{start:{line:22,column:9},end:{line:22,column:16}},loc:{start:{line:22,column:41},end:{line:22,column:341}},line:22},"1":{name:"(anonymous_1)",decl:{start:{line:22,column:208},end:{line:22,column:209}},loc:{start:{line:22,column:223},end:{line:22,column:290}},line:22},"2":{name:"_objectSpread",decl:{start:{line:24,column:9},end:{line:24,column:22}},loc:{start:{line:24,column:31},end:{line:24,column:535}},line:24},"3":{name:"(anonymous_3)",decl:{start:{line:24,column:176},end:{line:24,column:177}},loc:{start:{line:24,column:191},end:{line:24,column:254}},line:24},"4":{name:"(anonymous_4)",decl:{start:{line:24,column:412},end:{line:24,column:413}},loc:{start:{line:24,column:427},end:{line:24,column:512}},line:24},"5":{name:"(anonymous_5)",decl:{start:{line:28,column:0},end:{line:28,column:1}},loc:{start:{line:28,column:12},end:{line:85,column:1}},line:28},"6":{name:"_callee",decl:{start:{line:31,column:40},end:{line:31,column:47}},loc:{start:{line:31,column:64},end:{line:80,column:3}},line:31},"7":{name:"_callee$",decl:{start:{line:34,column:49},end:{line:34,column:57}},loc:{start:{line:34,column:68},end:{line:79,column:5}},line:34},"8":{name:"login",decl:{start:{line:82,column:18},end:{line:82,column:23}},loc:{start:{line:82,column:38},end:{line:84,column:3}},line:82},"9":{name:"auth",decl:{start:{line:87,column:20},end:{line:87,column:24}},loc:{start:{line:87,column:41},end:{line:90,column:1}},line:87},"10":{name:"authorizeFnList",decl:{start:{line:92,column:31},end:{line:92,column:46}},loc:{start:{line:92,column:55},end:{line:196,column:1}},line:92},"11":{name:"(anonymous_11)",decl:{start:{line:102,column:4},end:{line:102,column:5}},loc:{start:{line:102,column:16},end:{line:194,column:5}},line:102},"12":{name:"_callee2",decl:{start:{line:105,column:44},end:{line:105,column:52}},loc:{start:{line:105,column:69},end:{line:189,column:7}},line:105},"13":{name:"_callee2$",decl:{start:{line:108,column:53},end:{line:108,column:62}},loc:{start:{line:108,column:74},end:{line:188,column:9}},line:108},"14":{name:"(anonymous_14)",decl:{start:{line:191,column:13},end:{line:191,column:14}},loc:{start:{line:191,column:38},end:{line:193,column:7}},line:191},"15":{name:"(anonymous_15)",decl:{start:{line:198,column:38},end:{line:198,column:39}},loc:{start:{line:198,column:53},end:{line:200,column:1}},line:198},"16":{name:"(anonymous_16)",decl:{start:{line:204,column:45},end:{line:204,column:46}},loc:{start:{line:204,column:60},end:{line:206,column:1}},line:204},"17":{name:"(anonymous_17)",decl:{start:{line:206,column:3},end:{line:206,column:4}},loc:{start:{line:206,column:18},end:{line:208,column:1}},line:206}},branchMap:{"0":{loc:{start:{line:22,column:75},end:{line:22,column:326}},type:"if",locations:[{start:{line:22,column:75},end:{line:22,column:326}},{start:{line:22,column:75},end:{line:22,column:326}}],line:22},"1":{loc:{start:{line:22,column:163},end:{line:22,column:292}},type:"if",locations:[{start:{line:22,column:163},end:{line:22,column:292}},{start:{line:22,column:163},end:{line:22,column:292}}],line:22},"2":{loc:{start:{line:24,column:91},end:{line:24,column:131}},type:"cond-expr",locations:[{start:{line:24,column:114},end:{line:24,column:126}},{start:{line:24,column:129},end:{line:24,column:131}}],line:24},"3":{loc:{start:{line:24,column:133},end:{line:24,column:516}},type:"if",locations:[{start:{line:24,column:133},end:{line:24,column:516}},{start:{line:24,column:133},end:{line:24,column:516}}],line:24},"4":{loc:{start:{line:24,column:264},end:{line:24,column:516}},type:"if",locations:[{start:{line:24,column:264},end:{line:24,column:516}},{start:{line:24,column:264},end:{line:24,column:516}}],line:24},"5":{loc:{start:{line:36,column:8},end:{line:77,column:9}},type:"switch",locations:[{start:{line:37,column:10},end:{line:41,column:58}},{start:{line:43,column:10},end:{line:47,column:18}},{start:{line:49,column:10},end:{line:63,column:74}},{start:{line:65,column:10},end:{line:67,column:64}},{start:{line:69,column:10},end:{line:72,column:17}},{start:{line:74,column:10},end:{line:74,column:18}},{start:{line:75,column:10},end:{line:76,column:35}}],line:36},"6":{loc:{start:{line:53,column:12},end:{line:56,column:13}},type:"if",locations:[{start:{line:53,column:12},end:{line:56,column:13}},{start:{line:53,column:12},end:{line:56,column:13}}],line:53},"7":{loc:{start:{line:53,column:18},end:{line:53,column:105}},type:"binary-expr",locations:[{start:{line:53,column:18},end:{line:53,column:56}},{start:{line:53,column:60},end:{line:53,column:105}}],line:53},"8":{loc:{start:{line:93,column:14},end:{line:96,column:3}},type:"cond-expr",locations:[{start:{line:93,column:67},end:{line:93,column:79}},{start:{line:93,column:82},end:{line:96,column:3}}],line:93},"9":{loc:{start:{line:93,column:14},end:{line:93,column:64}},type:"binary-expr",locations:[{start:{line:93,column:14},end:{line:93,column:34}},{start:{line:93,column:38},end:{line:93,column:64}}],line:93},"10":{loc:{start:{line:110,column:12},end:{line:186,column:13}},type:"switch",locations:[{start:{line:111,column:14},end:{line:116,column:54}},{start:{line:118,column:14},end:{line:126,column:31}},{start:{line:128,column:14},end:{line:134,column:58}},{start:{line:136,column:14},end:{line:139,column:22}},{start:{line:141,column:14},end:{line:143,column:22}},{start:{line:145,column:14},end:{line:149,column:46}},{start:{line:151,column:14},end:{line:157,column:17}},{start:{line:159,column:14},end:{line:167,column:37}},{start:{line:169,column:14},end:{line:170,column:44}},{start:{line:172,column:14},end:{line:173,column:44}},{start:{line:175,column:14},end:{line:181,column:80}},{start:{line:183,column:14},end:{line:183,column:22}},{start:{line:184,column:14},end:{line:185,column:40}}],line:110},"11":{loc:{start:{line:119,column:16},end:{line:122,column:17}},type:"if",locations:[{start:{line:119,column:16},end:{line:122,column:17}},{start:{line:119,column:16},end:{line:122,column:17}}],line:119},"12":{loc:{start:{line:129,column:16},end:{line:132,column:17}},type:"if",locations:[{start:{line:129,column:16},end:{line:132,column:17}},{start:{line:129,column:16},end:{line:132,column:17}}],line:129},"13":{loc:{start:{line:155,column:16},end:{line:157,column:17}},type:"if",locations:[{start:{line:155,column:16},end:{line:157,column:17}},{start:{line:155,column:16},end:{line:157,column:17}}],line:155},"14":{loc:{start:{line:155,column:20},end:{line:155,column:77}},type:"binary-expr",locations:[{start:{line:155,column:20},end:{line:155,column:46}},{start:{line:155,column:50},end:{line:155,column:77}}],line:155},"15":{loc:{start:{line:162,column:16},end:{line:165,column:17}},type:"if",locations:[{start:{line:162,column:16},end:{line:165,column:17}},{start:{line:162,column:16},end:{line:165,column:17}}],line:162}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0,0,0,0,0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0,0,0,0,0,0,0,0,0,0,0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184",hash:"e5380452b9c8bc102c35906cd2632e21b53c8e3c"};var coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}return coverage[path]=coverageData;}();var _interopRequireDefault=(cov_ortbyt6o3.s[0]++,require("@babel/runtime/helpers/interopRequireDefault"));cov_ortbyt6o3.s[1]++;Object.defineProperty(exports,"__esModule",{value:true});cov_ortbyt6o3.s[2]++;exports["default"]=void 0;var _regenerator=(cov_ortbyt6o3.s[3]++,_interopRequireDefault(require("@babel/runtime/regenerator")));var _defineProperty2=(cov_ortbyt6o3.s[4]++,_interopRequireDefault(require("@babel/runtime/helpers/defineProperty")));var _asyncToGenerator2=(cov_ortbyt6o3.s[5]++,_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator")));var _jwtSimple=(cov_ortbyt6o3.s[6]++,_interopRequireDefault(require("jwt-simple")));var _security=(cov_ortbyt6o3.s[7]++,_interopRequireDefault(require("../config/security")));var _user=(cov_ortbyt6o3.s[8]++,_interopRequireDefault(require("../models/user")));function ownKeys(object,enumerableOnly){cov_ortbyt6o3.f[0]++;var keys=(cov_ortbyt6o3.s[9]++,Object.keys(object));cov_ortbyt6o3.s[10]++;if(Object.getOwnPropertySymbols){cov_ortbyt6o3.b[0][0]++;var symbols=(cov_ortbyt6o3.s[11]++,Object.getOwnPropertySymbols(object));cov_ortbyt6o3.s[12]++;if(enumerableOnly){cov_ortbyt6o3.b[1][0]++;cov_ortbyt6o3.s[13]++;symbols=symbols.filter(function(sym){cov_ortbyt6o3.f[1]++;cov_ortbyt6o3.s[14]++;return Object.getOwnPropertyDescriptor(object,sym).enumerable;});}else{cov_ortbyt6o3.b[1][1]++;}cov_ortbyt6o3.s[15]++;keys.push.apply(keys,symbols);}else{cov_ortbyt6o3.b[0][1]++;}cov_ortbyt6o3.s[16]++;return keys;}function _objectSpread(target){cov_ortbyt6o3.f[2]++;cov_ortbyt6o3.s[17]++;for(var i=(cov_ortbyt6o3.s[18]++,1);i<arguments.length;i++){var source=(cov_ortbyt6o3.s[19]++,arguments[i]!=null?(cov_ortbyt6o3.b[2][0]++,arguments[i]):(cov_ortbyt6o3.b[2][1]++,{}));cov_ortbyt6o3.s[20]++;if(i%2){cov_ortbyt6o3.b[3][0]++;cov_ortbyt6o3.s[21]++;ownKeys(source,true).forEach(function(key){cov_ortbyt6o3.f[3]++;cov_ortbyt6o3.s[22]++;(0,_defineProperty2["default"])(target,key,source[key]);});}else{cov_ortbyt6o3.b[3][1]++;cov_ortbyt6o3.s[23]++;if(Object.getOwnPropertyDescriptors){cov_ortbyt6o3.b[4][0]++;cov_ortbyt6o3.s[24]++;Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{cov_ortbyt6o3.b[4][1]++;cov_ortbyt6o3.s[25]++;ownKeys(source).forEach(function(key){cov_ortbyt6o3.f[4]++;cov_ortbyt6o3.s[26]++;Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}}cov_ortbyt6o3.s[27]++;return target;}var login=(/*#__PURE__*/cov_ortbyt6o3.s[28]++,function(){cov_ortbyt6o3.f[5]++;var _ref=(cov_ortbyt6o3.s[29]++,(0,_asyncToGenerator2["default"])(/*#__PURE__*/_regenerator["default"].mark(function _callee(req,res,next){cov_ortbyt6o3.f[6]++;var _req$body,email,password,user,token,error;cov_ortbyt6o3.s[30]++;return _regenerator["default"].wrap(function _callee$(_context){cov_ortbyt6o3.f[7]++;cov_ortbyt6o3.s[31]++;while(1){cov_ortbyt6o3.s[32]++;switch(_context.prev=_context.next){case 0:cov_ortbyt6o3.b[5][0]++;cov_ortbyt6o3.s[33]++;_req$body=req.body,email=_req$body.email,password=_req$body.password;cov_ortbyt6o3.s[34]++;_context.prev=1;cov_ortbyt6o3.s[35]++;_context.next=4;cov_ortbyt6o3.s[36]++;return _user["default"].find(email,password);case 4:cov_ortbyt6o3.b[5][1]++;cov_ortbyt6o3.s[37]++;user=_context.sent;cov_ortbyt6o3.s[38]++;token=_jwtSimple["default"].encode(user,_security["default"].jwtSecret);cov_ortbyt6o3.s[39]++;_context.next=18;cov_ortbyt6o3.s[40]++;break;case 8:cov_ortbyt6o3.b[5][2]++;cov_ortbyt6o3.s[41]++;_context.prev=8;cov_ortbyt6o3.s[42]++;_context.t0=_context["catch"](1);cov_ortbyt6o3.s[43]++;if(!((cov_ortbyt6o3.b[7][0]++,_context.t0.name=="INVALID_PASSWORD")||(cov_ortbyt6o3.b[7][1]++,_context.t0.name=="WRONG_PASSWORD_OR_EMAIL"))){cov_ortbyt6o3.b[6][0]++;cov_ortbyt6o3.s[44]++;_context.next=16;cov_ortbyt6o3.s[45]++;break;}else{cov_ortbyt6o3.b[6][1]++;}cov_ortbyt6o3.s[46]++;error={code:401,message:"[Unauthorized]\nLogin failed. Wrong email / password combination."};cov_ortbyt6o3.s[47]++;req.log.warn(error);cov_ortbyt6o3.s[48]++;return _context.abrupt("return",res.status(401).json(error));case 16:cov_ortbyt6o3.b[5][3]++;cov_ortbyt6o3.s[49]++;req.log.error(_context.t0);cov_ortbyt6o3.s[50]++;return _context.abrupt("return",next(_context.t0));case 18:cov_ortbyt6o3.b[5][4]++;cov_ortbyt6o3.s[51]++;return _context.abrupt("return",res.json(_objectSpread({},user,{token:"JWT ".concat(token)})));case 19:cov_ortbyt6o3.b[5][5]++;case"end":cov_ortbyt6o3.b[5][6]++;cov_ortbyt6o3.s[52]++;return _context.stop();}}},_callee,null,[[1,8]]);})));cov_ortbyt6o3.s[53]++;return function login(_x,_x2,_x3){cov_ortbyt6o3.f[8]++;cov_ortbyt6o3.s[54]++;return _ref.apply(this,arguments);};}());cov_ortbyt6o3.s[55]++;var auth=function auth(req,res,next){cov_ortbyt6o3.f[9]++;cov_ortbyt6o3.s[56]++;res.setHeader("X-Forwarded-User",JSON.stringify(req.user));cov_ortbyt6o3.s[57]++;return res.status(200).end('OK');};cov_ortbyt6o3.s[58]++;var authorizeFnList=function authorizeFnList(fnList){cov_ortbyt6o3.f[10]++;var _ref2=(cov_ortbyt6o3.s[59]++,(cov_ortbyt6o3.b[9][0]++,arguments.length>1)&&(cov_ortbyt6o3.b[9][1]++,arguments[1]!==undefined)?(cov_ortbyt6o3.b[8][0]++,arguments[1]):(cov_ortbyt6o3.b[8][1]++,{code:401,message:"Unauthorized !"})),code=(cov_ortbyt6o3.s[60]++,_ref2.code),message=(cov_ortbyt6o3.s[61]++,_ref2.message);cov_ortbyt6o3.s[62]++;return(/*#__PURE__*/function(){cov_ortbyt6o3.f[11]++;var _ref3=(cov_ortbyt6o3.s[63]++,(0,_asyncToGenerator2["default"])(/*#__PURE__*/_regenerator["default"].mark(function _callee2(req,res,next){cov_ortbyt6o3.f[12]++;var _iteratorNormalCompletion,_didIteratorError,_iteratorError,_iterator,_step,fn,error;cov_ortbyt6o3.s[64]++;return _regenerator["default"].wrap(function _callee2$(_context2){cov_ortbyt6o3.f[13]++;cov_ortbyt6o3.s[65]++;while(1){cov_ortbyt6o3.s[66]++;switch(_context2.prev=_context2.next){case 0:cov_ortbyt6o3.b[10][0]++;cov_ortbyt6o3.s[67]++;_iteratorNormalCompletion=true;cov_ortbyt6o3.s[68]++;_didIteratorError=false;cov_ortbyt6o3.s[69]++;_iteratorError=undefined;cov_ortbyt6o3.s[70]++;_context2.prev=3;cov_ortbyt6o3.s[71]++;_iterator=fnList[Symbol.iterator]();case 5:cov_ortbyt6o3.b[10][1]++;cov_ortbyt6o3.s[72]++;if(_iteratorNormalCompletion=(_step=_iterator.next()).done){cov_ortbyt6o3.b[11][0]++;cov_ortbyt6o3.s[73]++;_context2.next=14;cov_ortbyt6o3.s[74]++;break;}else{cov_ortbyt6o3.b[11][1]++;}cov_ortbyt6o3.s[75]++;fn=_step.value;cov_ortbyt6o3.s[76]++;_context2.next=9;cov_ortbyt6o3.s[77]++;return fn(req);case 9:cov_ortbyt6o3.b[10][2]++;cov_ortbyt6o3.s[78]++;if(!_context2.sent){cov_ortbyt6o3.b[12][0]++;cov_ortbyt6o3.s[79]++;_context2.next=11;cov_ortbyt6o3.s[80]++;break;}else{cov_ortbyt6o3.b[12][1]++;}cov_ortbyt6o3.s[81]++;return _context2.abrupt("return",next());case 11:cov_ortbyt6o3.b[10][3]++;cov_ortbyt6o3.s[82]++;_iteratorNormalCompletion=true;cov_ortbyt6o3.s[83]++;_context2.next=5;cov_ortbyt6o3.s[84]++;break;case 14:cov_ortbyt6o3.b[10][4]++;cov_ortbyt6o3.s[85]++;_context2.next=20;cov_ortbyt6o3.s[86]++;break;case 16:cov_ortbyt6o3.b[10][5]++;cov_ortbyt6o3.s[87]++;_context2.prev=16;cov_ortbyt6o3.s[88]++;_context2.t0=_context2["catch"](3);cov_ortbyt6o3.s[89]++;_didIteratorError=true;cov_ortbyt6o3.s[90]++;_iteratorError=_context2.t0;case 20:cov_ortbyt6o3.b[10][6]++;cov_ortbyt6o3.s[91]++;_context2.prev=20;cov_ortbyt6o3.s[92]++;_context2.prev=21;cov_ortbyt6o3.s[93]++;if((cov_ortbyt6o3.b[14][0]++,!_iteratorNormalCompletion)&&(cov_ortbyt6o3.b[14][1]++,_iterator["return"]!=null)){cov_ortbyt6o3.b[13][0]++;cov_ortbyt6o3.s[94]++;_iterator["return"]();}else{cov_ortbyt6o3.b[13][1]++;}case 23:cov_ortbyt6o3.b[10][7]++;cov_ortbyt6o3.s[95]++;_context2.prev=23;cov_ortbyt6o3.s[96]++;if(!_didIteratorError){cov_ortbyt6o3.b[15][0]++;cov_ortbyt6o3.s[97]++;_context2.next=26;cov_ortbyt6o3.s[98]++;break;}else{cov_ortbyt6o3.b[15][1]++;}cov_ortbyt6o3.s[99]++;throw _iteratorError;case 26:cov_ortbyt6o3.b[10][8]++;cov_ortbyt6o3.s[100]++;return _context2.finish(23);case 27:cov_ortbyt6o3.b[10][9]++;cov_ortbyt6o3.s[101]++;return _context2.finish(20);case 28:cov_ortbyt6o3.b[10][10]++;cov_ortbyt6o3.s[102]++;error={code:code,message:message};cov_ortbyt6o3.s[103]++;req.log.warn(error);cov_ortbyt6o3.s[104]++;return _context2.abrupt("return",res.status(code).json(error));case 31:cov_ortbyt6o3.b[10][11]++;case"end":cov_ortbyt6o3.b[10][12]++;cov_ortbyt6o3.s[105]++;return _context2.stop();}}},_callee2,null,[[3,16,20,28],[21,,23,27]]);})));cov_ortbyt6o3.s[106]++;return function(_x4,_x5,_x6){cov_ortbyt6o3.f[14]++;cov_ortbyt6o3.s[107]++;return _ref3.apply(this,arguments);};}());};var authorizeAdmin=(cov_ortbyt6o3.s[108]++,authorizeFnList([function(req){cov_ortbyt6o3.f[15]++;cov_ortbyt6o3.s[109]++;return req.user.role=="ADMIN";}],{code:403,message:"[Forbidden]\nOnly admin can use this route."}));var authorizeSelfAndAdmin=(cov_ortbyt6o3.s[110]++,authorizeFnList([function(req){cov_ortbyt6o3.f[16]++;cov_ortbyt6o3.s[111]++;return req.user.role=="ADMIN";},function(req){cov_ortbyt6o3.f[17]++;cov_ortbyt6o3.s[112]++;return req.user.id===parseInt(req.params.id);}],{code:403,message:"[Forbidden]\nOnly admin or self can use this route."}));var _default=(cov_ortbyt6o3.s[113]++,{login:login,auth:auth,authorizeFnList:authorizeFnList,authorizeSelfAndAdmin:authorizeSelfAndAdmin,authorizeAdmin:authorizeAdmin});cov_ortbyt6o3.s[114]++;exports["default"]=_default;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGguanMiXSwibmFtZXMiOlsibG9naW4iLCJyZXEiLCJyZXMiLCJuZXh0IiwiYm9keSIsImVtYWlsIiwicGFzc3dvcmQiLCJVc2VyIiwiZmluZCIsInVzZXIiLCJ0b2tlbiIsImp3dCIsImVuY29kZSIsInNlY3VyaXR5Q29uZmlnIiwiand0U2VjcmV0IiwibmFtZSIsImVycm9yIiwiY29kZSIsIm1lc3NhZ2UiLCJsb2ciLCJ3YXJuIiwic3RhdHVzIiwianNvbiIsImF1dGgiLCJzZXRIZWFkZXIiLCJKU09OIiwic3RyaW5naWZ5IiwiZW5kIiwiYXV0aG9yaXplRm5MaXN0IiwiZm5MaXN0IiwiZm4iLCJhdXRob3JpemVBZG1pbiIsInJvbGUiLCJhdXRob3JpemVTZWxmQW5kQWRtaW4iLCJpZCIsInBhcnNlSW50IiwicGFyYW1zIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFDQTs7Ozs7O0FBRUEsSUFBTUEsS0FBSztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsK0JBQUcsaUJBQU9DLEdBQVAsRUFBWUMsR0FBWixFQUFpQkMsSUFBakI7QUFBQTs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLHdCQUNnQkYsR0FBRyxDQUFDRyxJQURwQixFQUNIQyxLQURHLGFBQ0hBLEtBREcsRUFDSUMsUUFESixhQUNJQSxRQURKO0FBQUE7QUFBQTtBQUFBLG1CQUlXQyxpQkFBS0MsSUFBTCxDQUFVSCxLQUFWLEVBQWlCQyxRQUFqQixDQUpYOztBQUFBO0FBSUZHLFlBQUFBLElBSkU7QUFLRkMsWUFBQUEsS0FMRSxHQUtNQyxzQkFBSUMsTUFBSixDQUFXSCxJQUFYLEVBQWlCSSxxQkFBZUMsU0FBaEMsQ0FMTjtBQUFBO0FBQUE7O0FBQUE7QUFBQTtBQUFBOztBQUFBLGtCQVFGLFlBQUlDLElBQUosSUFBWSxrQkFBWixJQUNHLFlBQUlBLElBQUosSUFBWSx5QkFUYjtBQUFBO0FBQUE7QUFBQTs7QUFVSUMsWUFBQUEsS0FWSixHQVVZO0FBQ1ZD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QzFDLFVBQUEzQixHQUFHO0FBQUEsU0FBSUEsR0FBRyxDQUFDUSxJQUFKLENBQVN1QixJQUFULElBQWlCLE9BQXJCO0FBQUEsQ0FEdUMsRUFFMUMsVUFBQS9CLEdBQUc7QUFBQSxTQUFJQSxHQUFHLENBQUNRLElBQUosQ0FBU3lCLEVBQVQsS0FBZ0JDLFFBQVEsQ0FBQ2xDLEdBQUcsQ0FBQ21DLE1BQUosQ0FBV0YsRUFBWixDQUE1QjtBQUFBLENBRnVDLENBQUQsRUFHMUM7QUFBQ2pCLEVBQUFBLElBQUksRUFBRSxHQUFQO0FBQVlDLEVBQUFBLE9BQU87QUFBbkIsQ0FIMEMsQ0FBN0M7ZUFPZTtBQUFDbEIsRUFBQUEsS0FBSyxFQUFMQSxLQUFEO0FBQVF1QixFQUFBQSxJQUFJLEVBQUpBLElBQVI7QUFBY0ssRUFBQUEsZUFBZSxFQUFmQSxlQUFkO0FBQStCSyxFQUFBQSxxQkFBcUIsRUFBckJBLHFCQUEvQjtBQUFzREYsRUFBQUEsY0FBYyxFQUFkQTtBQUF0RCxDIiwic291cmNlUm9vdCI6Ii9ob21lL2Vyd2FuL0Rlc2t0b3AvRVROQS9NT0JJL21vYmlfYXBwbGkvQVBJL3NyYy9jb250cm9sbGVycyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBqd3QgICAgICAgICAgICBmcm9tICdqd3Qtc2ltcGxlJztcbmltcG9ydCBzZWN1cml0eUNvbmZpZyBmcm9tICcuLi9jb25maWcvc2VjdXJpdHknO1xuaW1wb3J0IFVzZXIgICAgICAgICAgIGZyb20gJy4uL21vZGVscy91c2VyJztcblxuY29uc3QgbG9naW4gPSBhc3luYyAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICBjb25zdCB7ZW1haWwsIHBhc3N3b3JkfSA9IHJlcS5ib2R5O1xuXG4gICAgdHJ5IHtcbiAgICAgICAgdmFyIHVzZXIgPSBhd2FpdCBVc2VyLmZpbmQoZW1haWwsIHBhc3N3b3JkKTtcbiAgICAgICAgdmFyIHRva2VuID0gand0LmVuY29kZSh1c2VyLCBzZWN1cml0eUNvbmZpZy5qd3RTZWNyZXQpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgZWxzZSAgKi9cbiAgICAgICAgaWYgKGVyci5uYW1lID09IFwiSU5WQUxJRF9QQVNTV09SRFwiXG4gICAgICAgICAgICB8fCBlcnIubmFtZSA9PSBcIldST05HX1BBU1NXT1JEX09SX0VNQUlMXCIpIHtcbiAgICAgICAgICAgIGNvbnN0IGVycm9yID0ge1xuICAgICAgICAgICAgICAgIGNvZGU6IDQwMSxcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBgW1VuYXV0aG9yaXplZF1cXG5Mb2dpbiBmYWlsZWQuIFdyb25nIGVtYWlsIC8gcGFzc3dvcmQgY29tYmluYXRpb24uYFxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgcmVxLmxvZy53YXJuKGVycm9yKTtcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuanNvbihlcnJvcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXEubG9nLmVycm9yKGVycik7XG4gICAgICAgICAgICByZXR1cm4gbmV4dChlcnIpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlcy5qc29uKHsuLi51c2VyLCB0b2tlbjogYEpXVCAke3Rva2VufWB9KTtcbn07XG5cbmNvbnN0IGF1dGggPSAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICByZXMuc2V0SGVhZGVyKFwiWC1Gb3J3YXJkZWQtVXNlclwiLCBKU09OLnN0cmluZ2lmeShyZXEudXNlcikpO1xuXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5lbmQoJ09LJyk7XG59O1xuXG5jb25zdCBhdXRob3JpemVGbkxpc3QgPSAoZm5MaXN0LCB7Y29kZSwgbWVzc2FnZX0gPSB7Y29kZTogNDAxLCBtZXNzYWdlOiBcIlVuYXV0aG9yaXplZCAhXCJ9KSA9PiBhc3luYyAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICBmb3IgKGxldCBmbiBvZiBmbkxpc3QpIHtcbiAgICAgICAgaWYgKGF3YWl0IGZuKHJlcSkpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXh0KCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBlcnJvciA9IHtcbiAgICAgICAgY29kZSxcbiAgICAgICAgbWVzc2FnZVxuICAgIH07XG5cbiAgICByZXEubG9nLndhcm4oZXJyb3IpO1xuICAgIHJldHVybiByZXMuc3RhdHVzKGNvZGUpLmpzb24oZXJyb3IpO1xufTtcblxuY29uc3QgYXV0aG9yaXplQWRtaW4gID0gYXV0aG9yaXplRm5MaXN0KFtcbiAgICByZXEgPT4gcmVxLnVzZXIucm9sZSA9PSBcIkFETUlOXCJcbl0sIHtjb2RlOiA0MDMsIG1lc3NhZ2U6IGBbRm9yYmlkZGVuXVxcbk9ubHkgYWRtaW4gY2FuIHVzZSB0aGlzIHJvdXRlLmB9KTtcblxuY29uc3QgYXV0aG9yaXplU2VsZkFuZEFkbWluID0gYXV0aG9yaXplRm5MaXN0KFtcbiAgICByZXEgPT4gcmVxLnVzZXIucm9sZSA9PSBcIkFETUlOXCIsXG4gICAgcmVxID0+IHJlcS51c2VyLmlkID09PSBwYXJzZUludChyZXEucGFyYW1zLmlkKVxuXSwge2NvZGU6IDQwMywgbWVzc2FnZTogYFtGb3JiaWRkZW5dXFxuT25seSBhZG1pbiBvciBzZWxmIGNhbiB1c2UgdGhpcyByb3V0ZS5gfSk7XG5cblxuXG5leHBvcnQgZGVmYXVsdCB7bG9naW4sIGF1dGgsIGF1dGhvcml6ZUZuTGlzdCwgYXV0aG9yaXplU2VsZkFuZEFkbWluLCBhdXRob3JpemVBZG1pbn07XG4iXX0=