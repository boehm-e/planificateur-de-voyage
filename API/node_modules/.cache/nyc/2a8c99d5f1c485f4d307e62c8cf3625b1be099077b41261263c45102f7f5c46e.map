{"version":3,"sources":["users.js"],"names":["getNotifications","user_id","GroupMember","getPendingByUser","pendingGroupInvitations","EventAtendee","pendingEventInvitations","groupNotifications","map","gInvit","nature","name","group","object_id","id","eventNotifications","eInvit","event","notifications"],"mappings":";;;;;;;;;;;;;;;AAAA;;AACA;;AACA;;AAEA,IAAMA,gBAAgB;AAAA;AAAA;AAAA;AAAA;AAAA,+BAAG,iBAAOC,OAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAEiBC,wBAAYC,gBAAZ,CAA6BF,OAA7B,CAFjB;;AAAA;AAEfG,YAAAA,uBAFe;AAAA;AAAA,mBAGiBC,yBAAaF,gBAAb,CAA8BF,OAA9B,CAHjB;;AAAA;AAGfK,YAAAA,uBAHe;AAKfC,YAAAA,kBALe,GAKMH,uBAAuB,CAACI,GAAxB,CAA4B,UAAAC,MAAM;AAAA,qBAAK;AAC9DR,gBAAAA,OAAO,EAAPA,OAD8D;AAE9DS,gBAAAA,MAAM,EAAE,QAFsD;AAG9DC,gBAAAA,IAAI,EAAEF,MAAM,CAACG,KAAP,CAAaD,IAH2C;AAI9DE,gBAAAA,SAAS,EAAEJ,MAAM,CAACG,KAAP,CAAaE;AAJsC,eAAL;AAAA,aAAlC,CALN;AAYfC,YAAAA,kBAZe,GAYMT,uBAAuB,CAACE,GAAxB,CAA4B,UAAAQ,MAAM;AAAA,qBAAK;AAC9Df,gBAAAA,OAAO,EAAPA,OAD8D;AAE9DS,gBAAAA,MAAM,EAAE,QAFsD;AAG9DC,gBAAAA,IAAI,EAAEK,MAAM,CAACC,KAAP,CAAaN,IAH2C;AAI9DE,gBAAAA,SAAS,EAAEG,MAAM,CAACC,KAAP,CAAaH;AAJsC,eAAL;AAAA,aAAlC,CAZN;AAmBfI,YAAAA,aAnBe,iDAoBdX,kBApBc,uCAqBdQ,kBArBc;AAAA,6CAwBdG,aAxBc;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAhBlB,gBAAgB;AAAA;AAAA;AAAA,GAAtB;;eA2Be;AAACA,EAAAA,gBAAgB,EAAhBA;AAAD,C","sourceRoot":"/home/erwan/Desktop/ETNA/MOBI/mobi_appli/API/src/services","sourcesContent":["import Bookshelf    from '../config/bookshelf';\nimport EventAtendee from '../models/eventAtendee';\nimport GroupMember  from '../models/groupMember';\n\nconst getNotifications = async (user_id) => {\n    // could be done in parallell\n    const pendingGroupInvitations = await GroupMember.getPendingByUser(user_id);\n    const pendingEventInvitations = await EventAtendee.getPendingByUser(user_id);\n\n    const groupNotifications = pendingGroupInvitations.map(gInvit => ({\n        user_id,\n        nature: 'groups',\n        name: gInvit.group.name,\n        object_id: gInvit.group.id\n    }));\n\n    const eventNotifications = pendingEventInvitations.map(eInvit => ({\n        user_id,\n        nature: 'events',\n        name: eInvit.event.name,\n        object_id: eInvit.event.id\n    }));\n\n    const notifications = [\n        ...groupNotifications,\n        ...eventNotifications\n    ];\n\n    return notifications;\n};\n\nexport default {getNotifications};\n"]}