"use strict";var cov_2n38a2jcsd=function(){var path="/home/erwan/Desktop/ETNA/MOBI/mobi_appli/API/src/models/group.js";var hash="98ef436b8f8087971babd1ad1a0adefc289d6210";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/erwan/Desktop/ETNA/MOBI/mobi_appli/API/src/models/group.js",statementMap:{"0":{start:{line:3,column:29},end:{line:3,column:84}},"1":{start:{line:5,column:19},end:{line:5,column:80}},"2":{start:{line:7,column:25},end:{line:7,column:99}},"3":{start:{line:9,column:14},end:{line:9,column:55}},"4":{start:{line:11,column:12},end:{line:11,column:53}},"5":{start:{line:13,column:19},end:{line:13,column:67}},"6":{start:{line:15,column:17},end:{line:15,column:71}},"7":{start:{line:17,column:14},end:{line:17,column:66}},"8":{start:{line:19,column:18},end:{line:19,column:74}},"9":{start:{line:21,column:12},end:{line:301,column:2}},"10":{start:{line:26,column:4},end:{line:26,column:45}},"11":{start:{line:29,column:4},end:{line:29,column:51}},"12":{start:{line:32,column:18},end:{line:61,column:7}},"13":{start:{line:36,column:6},end:{line:60,column:24}},"14":{start:{line:37,column:8},end:{line:59,column:9}},"15":{start:{line:38,column:10},end:{line:58,column:11}},"16":{start:{line:40,column:14},end:{line:40,column:102}},"17":{start:{line:41,column:14},end:{line:41,column:33}},"18":{start:{line:42,column:14},end:{line:42,column:32}},"19":{start:{line:43,column:14},end:{line:43,column:33}},"20":{start:{line:46,column:14},end:{line:48,column:16}},"21":{start:{line:49,column:14},end:{line:49,column:32}},"22":{start:{line:50,column:14},end:{line:50,column:54}},"23":{start:{line:53,column:14},end:{line:53,column:62}},"24":{start:{line:57,column:14},end:{line:57,column:37}},"25":{start:{line:64,column:6},end:{line:64,column:44}},"26":{start:{line:67,column:4},end:{line:67,column:18}},"27":{start:{line:70,column:19},end:{line:89,column:7}},"28":{start:{line:73,column:6},end:{line:88,column:25}},"29":{start:{line:74,column:8},end:{line:87,column:9}},"30":{start:{line:75,column:10},end:{line:86,column:11}},"31":{start:{line:77,column:14},end:{line:77,column:33}},"32":{start:{line:78,column:14},end:{line:78,column:36}},"33":{start:{line:81,column:14},end:{line:81,column:64}},"34":{start:{line:85,column:14},end:{line:85,column:38}},"35":{start:{line:92,column:6},end:{line:92,column:45}},"36":{start:{line:95,column:4},end:{line:95,column:19}},"37":{start:{line:99,column:18},end:{line:124,column:7}},"38":{start:{line:103,column:6},end:{line:123,column:25}},"39":{start:{line:104,column:8},end:{line:122,column:9}},"40":{start:{line:105,column:10},end:{line:121,column:11}},"41":{start:{line:107,column:14},end:{line:107,column:33}},"42":{start:{line:108,column:14},end:{line:110,column:17}},"43":{start:{line:113,column:14},end:{line:113,column:41}},"44":{start:{line:114,column:14},end:{line:116,column:52}},"45":{start:{line:115,column:16},end:{line:115,column:38}},"46":{start:{line:120,column:14},end:{line:120,column:38}},"47":{start:{line:127,column:6},end:{line:127,column:44}},"48":{start:{line:130,column:4},end:{line:130,column:18}},"49":{start:{line:133,column:21},end:{line:166,column:7}},"50":{start:{line:137,column:6},end:{line:165,column:25}},"51":{start:{line:138,column:8},end:{line:164,column:9}},"52":{start:{line:139,column:10},end:{line:163,column:11}},"53":{start:{line:141,column:14},end:{line:141,column:33}},"54":{start:{line:142,column:14},end:{line:142,column:221}},"55":{start:{line:145,column:14},end:{line:145,column:41}},"56":{start:{line:146,column:14},end:{line:148,column:17}},"57":{start:{line:147,column:16},end:{line:147,column:28}},"58":{start:{line:149,column:14},end:{line:149,column:33}},"59":{start:{line:150,column:14},end:{line:152,column:17}},"60":{start:{line:155,column:14},end:{line:155,column:38}},"61":{start:{line:156,column:14},end:{line:158,column:52}},"62":{start:{line:157,column:16},end:{line:157,column:38}},"63":{start:{line:162,column:14},end:{line:162,column:38}},"64":{start:{line:169,column:6},end:{line:169,column:47}},"65":{start:{line:172,column:4},end:{line:172,column:21}},"66":{start:{line:175,column:19},end:{line:209,column:7}},"67":{start:{line:179,column:6},end:{line:208,column:25}},"68":{start:{line:180,column:8},end:{line:207,column:9}},"69":{start:{line:181,column:10},end:{line:206,column:11}},"70":{start:{line:183,column:14},end:{line:183,column:33}},"71":{start:{line:184,column:14},end:{line:188,column:17}},"72":{start:{line:191,column:14},end:{line:191,column:37}},"73":{start:{line:193,column:14},end:{line:196,column:15}},"74":{start:{line:194,column:16},end:{line:194,column:35}},"75":{start:{line:195,column:16},end:{line:195,column:22}},"76":{start:{line:198,column:14},end:{line:198,column:61}},"77":{start:{line:201,column:14},end:{line:201,column:94}},"78":{start:{line:205,column:14},end:{line:205,column:38}},"79":{start:{line:212,column:6},end:{line:212,column:45}},"80":{start:{line:215,column:4},end:{line:215,column:19}},"81":{start:{line:218,column:18},end:{line:249,column:7}},"82":{start:{line:222,column:6},end:{line:248,column:25}},"83":{start:{line:223,column:8},end:{line:247,column:9}},"84":{start:{line:224,column:10},end:{line:246,column:11}},"85":{start:{line:226,column:14},end:{line:226,column:91}},"86":{start:{line:227,column:14},end:{line:227,column:33}},"87":{start:{line:228,column:14},end:{line:228,column:47}},"88":{start:{line:231,column:14},end:{line:231,column:42}},"89":{start:{line:232,column:14},end:{line:232,column:33}},"90":{start:{line:233,column:14},end:{line:237,column:17}},"91":{start:{line:240,column:14},end:{line:240,column:37}},"92":{start:{line:241,column:14},end:{line:241,column:94}},"93":{start:{line:245,column:14},end:{line:245,column:38}},"94":{start:{line:252,column:6},end:{line:252,column:44}},"95":{start:{line:255,column:4},end:{line:255,column:18}},"96":{start:{line:258,column:19},end:{line:293,column:7}},"97":{start:{line:262,column:6},end:{line:292,column:35}},"98":{start:{line:263,column:8},end:{line:291,column:9}},"99":{start:{line:264,column:10},end:{line:290,column:11}},"100":{start:{line:266,column:14},end:{line:266,column:33}},"101":{start:{line:267,column:14},end:{line:267,column:33}},"102":{start:{line:268,column:14},end:{line:272,column:17}},"103":{start:{line:275,column:14},end:{line:275,column:39}},"104":{start:{line:276,column:14},end:{line:276,column:33}},"105":{start:{line:277,column:14},end:{line:277,column:20}},"106":{start:{line:280,column:14},end:{line:280,column:33}},"107":{start:{line:281,column:14},end:{line:281,column:51}},"108":{start:{line:282,column:14},end:{line:282,column:55}},"109":{start:{line:285,column:14},end:{line:285,column:54}},"110":{start:{line:289,column:14},end:{line:289,column:38}},"111":{start:{line:296,column:6},end:{line:296,column:45}},"112":{start:{line:299,column:4},end:{line:299,column:19}},"113":{start:{line:303,column:0},end:{line:303,column:61}}},fnMap:{"0":{name:"user",decl:{start:{line:25,column:17},end:{line:25,column:21}},loc:{start:{line:25,column:24},end:{line:27,column:3}},line:25},"1":{name:"members",decl:{start:{line:28,column:20},end:{line:28,column:27}},loc:{start:{line:28,column:30},end:{line:30,column:3}},line:28},"2":{name:"(anonymous_2)",decl:{start:{line:31,column:10},end:{line:31,column:11}},loc:{start:{line:31,column:22},end:{line:68,column:3}},line:31},"3":{name:"_callee",decl:{start:{line:34,column:42},end:{line:34,column:49}},loc:{start:{line:34,column:56},end:{line:61,column:5}},line:34},"4":{name:"_callee$",decl:{start:{line:36,column:51},end:{line:36,column:59}},loc:{start:{line:36,column:70},end:{line:60,column:7}},line:36},"5":{name:"update",decl:{start:{line:63,column:13},end:{line:63,column:19}},loc:{start:{line:63,column:24},end:{line:65,column:5}},line:63},"6":{name:"(anonymous_6)",decl:{start:{line:69,column:12},end:{line:69,column:13}},loc:{start:{line:69,column:24},end:{line:96,column:3}},line:69},"7":{name:"_callee2",decl:{start:{line:72,column:42},end:{line:72,column:50}},loc:{start:{line:72,column:53},end:{line:89,column:5}},line:72},"8":{name:"_callee2$",decl:{start:{line:73,column:51},end:{line:73,column:60}},loc:{start:{line:73,column:72},end:{line:88,column:7}},line:73},"9":{name:"_delete",decl:{start:{line:91,column:13},end:{line:91,column:20}},loc:{start:{line:91,column:23},end:{line:93,column:5}},line:91},"10":{name:"(anonymous_10)",decl:{start:{line:98,column:10},end:{line:98,column:11}},loc:{start:{line:98,column:22},end:{line:131,column:3}},line:98},"11":{name:"_callee3",decl:{start:{line:101,column:42},end:{line:101,column:50}},loc:{start:{line:101,column:53},end:{line:124,column:5}},line:101},"12":{name:"_callee3$",decl:{start:{line:103,column:51},end:{line:103,column:60}},loc:{start:{line:103,column:72},end:{line:123,column:7}},line:103},"13":{name:"(anonymous_13)",decl:{start:{line:114,column:62},end:{line:114,column:63}},loc:{start:{line:114,column:79},end:{line:116,column:15}},line:114},"14":{name:"getAll",decl:{start:{line:126,column:13},end:{line:126,column:19}},loc:{start:{line:126,column:22},end:{line:128,column:5}},line:126},"15":{name:"(anonymous_15)",decl:{start:{line:132,column:13},end:{line:132,column:14}},loc:{start:{line:132,column:25},end:{line:173,column:3}},line:132},"16":{name:"_callee4",decl:{start:{line:135,column:42},end:{line:135,column:50}},loc:{start:{line:135,column:60},end:{line:166,column:5}},line:135},"17":{name:"_callee4$",decl:{start:{line:137,column:51},end:{line:137,column:60}},loc:{start:{line:137,column:72},end:{line:165,column:7}},line:137},"18":{name:"(anonymous_18)",decl:{start:{line:146,column:47},end:{line:146,column:48}},loc:{start:{line:146,column:60},end:{line:148,column:15}},line:146},"19":{name:"(anonymous_19)",decl:{start:{line:156,column:59},end:{line:156,column:60}},loc:{start:{line:156,column:76},end:{line:158,column:15}},line:156},"20":{name:"getByUser",decl:{start:{line:168,column:13},end:{line:168,column:22}},loc:{start:{line:168,column:28},end:{line:170,column:5}},line:168},"21":{name:"(anonymous_21)",decl:{start:{line:174,column:11},end:{line:174,column:12}},loc:{start:{line:174,column:23},end:{line:216,column:3}},line:174},"22":{name:"_callee5",decl:{start:{line:177,column:42},end:{line:177,column:50}},loc:{start:{line:177,column:55},end:{line:209,column:5}},line:177},"23":{name:"_callee5$",decl:{start:{line:179,column:51},end:{line:179,column:60}},loc:{start:{line:179,column:72},end:{line:208,column:7}},line:179},"24":{name:"getById",decl:{start:{line:211,column:13},end:{line:211,column:20}},loc:{start:{line:211,column:26},end:{line:213,column:5}},line:211},"25":{name:"(anonymous_25)",decl:{start:{line:217,column:10},end:{line:217,column:11}},loc:{start:{line:217,column:22},end:{line:256,column:3}},line:217},"26":{name:"_callee6",decl:{start:{line:220,column:42},end:{line:220,column:50}},loc:{start:{line:220,column:57},end:{line:249,column:5}},line:220},"27":{name:"_callee6$",decl:{start:{line:222,column:51},end:{line:222,column:60}},loc:{start:{line:222,column:72},end:{line:248,column:7}},line:222},"28":{name:"create",decl:{start:{line:251,column:13},end:{line:251,column:19}},loc:{start:{line:251,column:25},end:{line:253,column:5}},line:251},"29":{name:"(anonymous_29)",decl:{start:{line:257,column:12},end:{line:257,column:13}},loc:{start:{line:257,column:24},end:{line:300,column:3}},line:257},"30":{name:"_callee7",decl:{start:{line:260,column:42},end:{line:260,column:50}},loc:{start:{line:260,column:55},end:{line:293,column:5}},line:260},"31":{name:"_callee7$",decl:{start:{line:262,column:51},end:{line:262,column:60}},loc:{start:{line:262,column:72},end:{line:292,column:7}},line:262},"32":{name:"_delete",decl:{start:{line:295,column:13},end:{line:295,column:20}},loc:{start:{line:295,column:26},end:{line:297,column:5}},line:295}},branchMap:{"0":{loc:{start:{line:38,column:10},end:{line:58,column:11}},type:"switch",locations:[{start:{line:39,column:12},end:{line:43,column:33}},{start:{line:45,column:12},end:{line:50,column:54}},{start:{line:52,column:12},end:{line:53,column:62}},{start:{line:55,column:12},end:{line:55,column:19}},{start:{line:56,column:12},end:{line:57,column:37}}],line:38},"1":{loc:{start:{line:75,column:10},end:{line:86,column:11}},type:"switch",locations:[{start:{line:76,column:12},end:{line:78,column:36}},{start:{line:80,column:12},end:{line:81,column:64}},{start:{line:83,column:12},end:{line:83,column:19}},{start:{line:84,column:12},end:{line:85,column:38}}],line:75},"2":{loc:{start:{line:105,column:10},end:{line:121,column:11}},type:"switch",locations:[{start:{line:106,column:12},end:{line:110,column:17}},{start:{line:112,column:12},end:{line:116,column:52}},{start:{line:118,column:12},end:{line:118,column:19}},{start:{line:119,column:12},end:{line:120,column:38}}],line:105},"3":{loc:{start:{line:139,column:10},end:{line:163,column:11}},type:"switch",locations:[{start:{line:140,column:12},end:{line:142,column:221}},{start:{line:144,column:12},end:{line:152,column:17}},{start:{line:154,column:12},end:{line:158,column:52}},{start:{line:160,column:12},end:{line:160,column:19}},{start:{line:161,column:12},end:{line:162,column:38}}],line:139},"4":{loc:{start:{line:181,column:10},end:{line:206,column:11}},type:"switch",locations:[{start:{line:182,column:12},end:{line:188,column:17}},{start:{line:190,column:12},end:{line:198,column:61}},{start:{line:200,column:12},end:{line:201,column:94}},{start:{line:203,column:12},end:{line:203,column:19}},{start:{line:204,column:12},end:{line:205,column:38}}],line:181},"5":{loc:{start:{line:193,column:14},end:{line:196,column:15}},type:"if",locations:[{start:{line:193,column:14},end:{line:196,column:15}},{start:{line:193,column:14},end:{line:196,column:15}}],line:193},"6":{loc:{start:{line:224,column:10},end:{line:246,column:11}},type:"switch",locations:[{start:{line:225,column:12},end:{line:228,column:47}},{start:{line:230,column:12},end:{line:237,column:17}},{start:{line:239,column:12},end:{line:241,column:94}},{start:{line:243,column:12},end:{line:243,column:19}},{start:{line:244,column:12},end:{line:245,column:38}}],line:224},"7":{loc:{start:{line:264,column:10},end:{line:290,column:11}},type:"switch",locations:[{start:{line:265,column:12},end:{line:272,column:17}},{start:{line:274,column:12},end:{line:277,column:20}},{start:{line:279,column:12},end:{line:282,column:55}},{start:{line:284,column:12},end:{line:285,column:54}},{start:{line:287,column:12},end:{line:287,column:20}},{start:{line:288,column:12},end:{line:289,column:38}}],line:264}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0},b:{"0":[0,0,0,0,0],"1":[0,0,0,0],"2":[0,0,0,0],"3":[0,0,0,0,0],"4":[0,0,0,0,0],"5":[0,0],"6":[0,0,0,0,0],"7":[0,0,0,0,0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184",hash:"98ef436b8f8087971babd1ad1a0adefc289d6210"};var coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}return coverage[path]=coverageData;}();var _interopRequireDefault=(cov_2n38a2jcsd.s[0]++,require("@babel/runtime/helpers/interopRequireDefault"));var _regenerator=(cov_2n38a2jcsd.s[1]++,_interopRequireDefault(require("@babel/runtime/regenerator")));var _asyncToGenerator2=(cov_2n38a2jcsd.s[2]++,_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator")));var _lodash=(cov_2n38a2jcsd.s[3]++,_interopRequireDefault(require("lodash")));var _user=(cov_2n38a2jcsd.s[4]++,_interopRequireDefault(require("./user")));var _groupMember=(cov_2n38a2jcsd.s[5]++,_interopRequireDefault(require("./groupMember")));var _bookshelf=(cov_2n38a2jcsd.s[6]++,_interopRequireDefault(require("../config/bookshelf")));var _errors=(cov_2n38a2jcsd.s[7]++,_interopRequireDefault(require("../helpers/errors")));var _formatters=(cov_2n38a2jcsd.s[8]++,_interopRequireDefault(require("../helpers/formatters")));var Group=(cov_2n38a2jcsd.s[9]++,_bookshelf["default"].Model.extend({tableName:'groups',idAttribute:'id',hidden:[],user:function user(){cov_2n38a2jcsd.f[0]++;cov_2n38a2jcsd.s[10]++;return this.belongsTo('User','user_id');},members:function members(){cov_2n38a2jcsd.f[1]++;cov_2n38a2jcsd.s[11]++;return this.hasMany('GroupMember','group_id');},update:function(){cov_2n38a2jcsd.f[2]++;var _update=(cov_2n38a2jcsd.s[12]++,(0,_asyncToGenerator2["default"])(/*#__PURE__*/_regenerator["default"].mark(function _callee(body){cov_2n38a2jcsd.f[3]++;var realbody;cov_2n38a2jcsd.s[13]++;return _regenerator["default"].wrap(function _callee$(_context){cov_2n38a2jcsd.f[4]++;cov_2n38a2jcsd.s[14]++;while(1){cov_2n38a2jcsd.s[15]++;switch(_context.prev=_context.next){case 0:cov_2n38a2jcsd.b[0][0]++;cov_2n38a2jcsd.s[16]++;realbody=_lodash["default"].pick(body,['name','description','deleted','user_id']);cov_2n38a2jcsd.s[17]++;this.set(realbody);cov_2n38a2jcsd.s[18]++;_context.next=4;cov_2n38a2jcsd.s[19]++;return this.save();case 4:cov_2n38a2jcsd.b[0][1]++;cov_2n38a2jcsd.s[20]++;_context.t0={withRelated:['user','user.role','members','members.user','members.user.role']};cov_2n38a2jcsd.s[21]++;_context.next=7;cov_2n38a2jcsd.s[22]++;return _context.sent.fetch(_context.t0);case 7:cov_2n38a2jcsd.b[0][2]++;cov_2n38a2jcsd.s[23]++;return _context.abrupt("return",_context.sent);case 8:cov_2n38a2jcsd.b[0][3]++;case"end":cov_2n38a2jcsd.b[0][4]++;cov_2n38a2jcsd.s[24]++;return _context.stop();}}},_callee,this);})));function update(_x){cov_2n38a2jcsd.f[5]++;cov_2n38a2jcsd.s[25]++;return _update.apply(this,arguments);}cov_2n38a2jcsd.s[26]++;return update;}(),"delete":function(){cov_2n38a2jcsd.f[6]++;var _delete2=(cov_2n38a2jcsd.s[27]++,(0,_asyncToGenerator2["default"])(/*#__PURE__*/_regenerator["default"].mark(function _callee2(){cov_2n38a2jcsd.f[7]++;cov_2n38a2jcsd.s[28]++;return _regenerator["default"].wrap(function _callee2$(_context2){cov_2n38a2jcsd.f[8]++;cov_2n38a2jcsd.s[29]++;while(1){cov_2n38a2jcsd.s[30]++;switch(_context2.prev=_context2.next){case 0:cov_2n38a2jcsd.b[1][0]++;cov_2n38a2jcsd.s[31]++;_context2.next=2;cov_2n38a2jcsd.s[32]++;return this.destroy();case 2:cov_2n38a2jcsd.b[1][1]++;cov_2n38a2jcsd.s[33]++;return _context2.abrupt("return",_context2.sent);case 3:cov_2n38a2jcsd.b[1][2]++;case"end":cov_2n38a2jcsd.b[1][3]++;cov_2n38a2jcsd.s[34]++;return _context2.stop();}}},_callee2,this);})));function _delete(){cov_2n38a2jcsd.f[9]++;cov_2n38a2jcsd.s[35]++;return _delete2.apply(this,arguments);}cov_2n38a2jcsd.s[36]++;return _delete;}()},{getAll:function(){cov_2n38a2jcsd.f[10]++;var _getAll=(cov_2n38a2jcsd.s[37]++,(0,_asyncToGenerator2["default"])(/*#__PURE__*/_regenerator["default"].mark(function _callee3(){cov_2n38a2jcsd.f[11]++;var groupList;cov_2n38a2jcsd.s[38]++;return _regenerator["default"].wrap(function _callee3$(_context3){cov_2n38a2jcsd.f[12]++;cov_2n38a2jcsd.s[39]++;while(1){cov_2n38a2jcsd.s[40]++;switch(_context3.prev=_context3.next){case 0:cov_2n38a2jcsd.b[2][0]++;cov_2n38a2jcsd.s[41]++;_context3.next=2;cov_2n38a2jcsd.s[42]++;return this.query({}).fetchAll({withRelated:['user','user.role','members','members.user','members.user.role']});case 2:cov_2n38a2jcsd.b[2][1]++;cov_2n38a2jcsd.s[43]++;groupList=_context3.sent;cov_2n38a2jcsd.s[44]++;return _context3.abrupt("return",groupList.map(function(group){cov_2n38a2jcsd.f[13]++;cov_2n38a2jcsd.s[45]++;return group.toJSON();}).map(_formatters["default"].group));case 4:cov_2n38a2jcsd.b[2][2]++;case"end":cov_2n38a2jcsd.b[2][3]++;cov_2n38a2jcsd.s[46]++;return _context3.stop();}}},_callee3,this);})));function getAll(){cov_2n38a2jcsd.f[14]++;cov_2n38a2jcsd.s[47]++;return _getAll.apply(this,arguments);}cov_2n38a2jcsd.s[48]++;return getAll;}(),getByUser:function(){cov_2n38a2jcsd.f[15]++;var _getByUser=(cov_2n38a2jcsd.s[49]++,(0,_asyncToGenerator2["default"])(/*#__PURE__*/_regenerator["default"].mark(function _callee4(user_id){cov_2n38a2jcsd.f[16]++;var rawResult,userGroupsIds,groups;cov_2n38a2jcsd.s[50]++;return _regenerator["default"].wrap(function _callee4$(_context4){cov_2n38a2jcsd.f[17]++;cov_2n38a2jcsd.s[51]++;while(1){cov_2n38a2jcsd.s[52]++;switch(_context4.prev=_context4.next){case 0:cov_2n38a2jcsd.b[3][0]++;cov_2n38a2jcsd.s[53]++;_context4.next=2;cov_2n38a2jcsd.s[54]++;return _bookshelf["default"].knex.raw("SELECT groups.id FROM groups LEFT JOIN group_members ON group_members.group_id = groups.id  WHERE groups.user_id = ? OR group_members.user_id = ?",[user_id,user_id]);case 2:cov_2n38a2jcsd.b[3][1]++;cov_2n38a2jcsd.s[55]++;rawResult=_context4.sent;cov_2n38a2jcsd.s[56]++;userGroupsIds=rawResult[0].map(function(o){cov_2n38a2jcsd.f[18]++;cov_2n38a2jcsd.s[57]++;return o.id;});cov_2n38a2jcsd.s[58]++;_context4.next=6;cov_2n38a2jcsd.s[59]++;return this.where('id','in',userGroupsIds).fetchAll({withRelated:['user','user.role','members','members.user','members.user.role']});case 6:cov_2n38a2jcsd.b[3][2]++;cov_2n38a2jcsd.s[60]++;groups=_context4.sent;cov_2n38a2jcsd.s[61]++;return _context4.abrupt("return",groups.map(function(group){cov_2n38a2jcsd.f[19]++;cov_2n38a2jcsd.s[62]++;return group.toJSON();}).map(_formatters["default"].group));case 8:cov_2n38a2jcsd.b[3][3]++;case"end":cov_2n38a2jcsd.b[3][4]++;cov_2n38a2jcsd.s[63]++;return _context4.stop();}}},_callee4,this);})));function getByUser(_x2){cov_2n38a2jcsd.f[20]++;cov_2n38a2jcsd.s[64]++;return _getByUser.apply(this,arguments);}cov_2n38a2jcsd.s[65]++;return getByUser;}(),getById:function(){cov_2n38a2jcsd.f[21]++;var _getById=(cov_2n38a2jcsd.s[66]++,(0,_asyncToGenerator2["default"])(/*#__PURE__*/_regenerator["default"].mark(function _callee5(id){cov_2n38a2jcsd.f[22]++;var group;cov_2n38a2jcsd.s[67]++;return _regenerator["default"].wrap(function _callee5$(_context5){cov_2n38a2jcsd.f[23]++;cov_2n38a2jcsd.s[68]++;while(1){cov_2n38a2jcsd.s[69]++;switch(_context5.prev=_context5.next){case 0:cov_2n38a2jcsd.b[4][0]++;cov_2n38a2jcsd.s[70]++;_context5.next=2;cov_2n38a2jcsd.s[71]++;return this.where({id:id}).fetch({withRelated:['user','user.role','members','members.user','members.user.role']});case 2:cov_2n38a2jcsd.b[4][1]++;cov_2n38a2jcsd.s[72]++;group=_context5.sent;cov_2n38a2jcsd.s[73]++;if(!(group==null)){cov_2n38a2jcsd.b[5][0]++;cov_2n38a2jcsd.s[74]++;_context5.next=6;cov_2n38a2jcsd.s[75]++;break;}else{cov_2n38a2jcsd.b[5][1]++;}cov_2n38a2jcsd.s[76]++;throw new _errors["default"].GROUP_NOT_FOUND();case 6:cov_2n38a2jcsd.b[4][2]++;cov_2n38a2jcsd.s[77]++;return _context5.abrupt("return",_formatters["default"].group(group.toJSON()));case 7:cov_2n38a2jcsd.b[4][3]++;case"end":cov_2n38a2jcsd.b[4][4]++;cov_2n38a2jcsd.s[78]++;return _context5.stop();}}},_callee5,this);})));function getById(_x3){cov_2n38a2jcsd.f[24]++;cov_2n38a2jcsd.s[79]++;return _getById.apply(this,arguments);}cov_2n38a2jcsd.s[80]++;return getById;}(),create:function(){cov_2n38a2jcsd.f[25]++;var _create=(cov_2n38a2jcsd.s[81]++,(0,_asyncToGenerator2["default"])(/*#__PURE__*/_regenerator["default"].mark(function _callee6(body){cov_2n38a2jcsd.f[26]++;var realbody,e,group;cov_2n38a2jcsd.s[82]++;return _regenerator["default"].wrap(function _callee6$(_context6){cov_2n38a2jcsd.f[27]++;cov_2n38a2jcsd.s[83]++;while(1){cov_2n38a2jcsd.s[84]++;switch(_context6.prev=_context6.next){case 0:cov_2n38a2jcsd.b[6][0]++;cov_2n38a2jcsd.s[85]++;realbody=_lodash["default"].pick(body,['name','description','user_id']);cov_2n38a2jcsd.s[86]++;_context6.next=3;cov_2n38a2jcsd.s[87]++;return new this(realbody).save();case 3:cov_2n38a2jcsd.b[6][1]++;cov_2n38a2jcsd.s[88]++;e=_context6.sent.toJSON();cov_2n38a2jcsd.s[89]++;_context6.next=6;cov_2n38a2jcsd.s[90]++;return this.where({id:e.id}).fetch({withRelated:['user','user.role','members','members.user','members.user.role']});case 6:cov_2n38a2jcsd.b[6][2]++;cov_2n38a2jcsd.s[91]++;group=_context6.sent;cov_2n38a2jcsd.s[92]++;return _context6.abrupt("return",_formatters["default"].group(group.toJSON()));case 8:cov_2n38a2jcsd.b[6][3]++;case"end":cov_2n38a2jcsd.b[6][4]++;cov_2n38a2jcsd.s[93]++;return _context6.stop();}}},_callee6,this);})));function create(_x4){cov_2n38a2jcsd.f[28]++;cov_2n38a2jcsd.s[94]++;return _create.apply(this,arguments);}cov_2n38a2jcsd.s[95]++;return create;}(),"delete":function(){cov_2n38a2jcsd.f[29]++;var _delete3=(cov_2n38a2jcsd.s[96]++,(0,_asyncToGenerator2["default"])(/*#__PURE__*/_regenerator["default"].mark(function _callee7(id){cov_2n38a2jcsd.f[30]++;var destroy;cov_2n38a2jcsd.s[97]++;return _regenerator["default"].wrap(function _callee7$(_context7){cov_2n38a2jcsd.f[31]++;cov_2n38a2jcsd.s[98]++;while(1){cov_2n38a2jcsd.s[99]++;switch(_context7.prev=_context7.next){case 0:cov_2n38a2jcsd.b[7][0]++;cov_2n38a2jcsd.s[100]++;_context7.prev=0;cov_2n38a2jcsd.s[101]++;_context7.next=3;cov_2n38a2jcsd.s[102]++;return new this({id:id}).destroy({require:true});case 3:cov_2n38a2jcsd.b[7][1]++;cov_2n38a2jcsd.s[103]++;destroy=_context7.sent;cov_2n38a2jcsd.s[104]++;_context7.next=9;cov_2n38a2jcsd.s[105]++;break;case 6:cov_2n38a2jcsd.b[7][2]++;cov_2n38a2jcsd.s[106]++;_context7.prev=6;cov_2n38a2jcsd.s[107]++;_context7.t0=_context7["catch"](0);cov_2n38a2jcsd.s[108]++;return _context7.abrupt("return",false);case 9:cov_2n38a2jcsd.b[7][3]++;cov_2n38a2jcsd.s[109]++;return _context7.abrupt("return",true);case 10:cov_2n38a2jcsd.b[7][4]++;case"end":cov_2n38a2jcsd.b[7][5]++;cov_2n38a2jcsd.s[110]++;return _context7.stop();}}},_callee7,this,[[0,6]]);})));function _delete(_x5){cov_2n38a2jcsd.f[32]++;cov_2n38a2jcsd.s[111]++;return _delete3.apply(this,arguments);}cov_2n38a2jcsd.s[112]++;return _delete;}()}));cov_2n38a2jcsd.s[113]++;module.exports=_bookshelf["default"].model('Group',Group);//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdyb3VwLmpzIl0sIm5hbWVzIjpbIkdyb3VwIiwiQm9va3NoZWxmIiwiTW9kZWwiLCJleHRlbmQiLCJ0YWJsZU5hbWUiLCJpZEF0dHJpYnV0ZSIsImhpZGRlbiIsInVzZXIiLCJiZWxvbmdzVG8iLCJtZW1iZXJzIiwiaGFzTWFueSIsInVwZGF0ZSIsImJvZHkiLCJyZWFsYm9keSIsIl8iLCJwaWNrIiwic2V0Iiwic2F2ZSIsIndpdGhSZWxhdGVkIiwiZmV0Y2giLCJkZXN0cm95IiwiZ2V0QWxsIiwicXVlcnkiLCJmZXRjaEFsbCIsImdyb3VwTGlzdCIsIm1hcCIsImdyb3VwIiwidG9KU09OIiwiZm10IiwiZ2V0QnlVc2VyIiwidXNlcl9pZCIsImtuZXgiLCJyYXciLCJyYXdSZXN1bHQiLCJ1c2VyR3JvdXBzSWRzIiwibyIsImlkIiwid2hlcmUiLCJncm91cHMiLCJnZXRCeUlkIiwiZXJyb3JzIiwiR1JPVVBfTk9UX0ZPVU5EIiwiY3JlYXRlIiwiZSIsInJlcXVpcmUiLCJtb2R1bGUiLCJleHBvcnRzIiwibW9kZWwiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBRUEsSUFBSUEsS0FBSyxHQUFHQyxzQkFBVUMsS0FBVixDQUFnQkMsTUFBaEIsQ0FBdUI7QUFDL0JDLEVBQUFBLFNBQVMsRUFBRSxRQURvQjtBQUUvQkMsRUFBQUEsV0FBVyxFQUFFLElBRmtCO0FBRy9CQyxFQUFBQSxNQUFNLEVBQUUsRUFIdUI7QUFLL0JDLEVBQUFBLElBTCtCLGtCQUt4QjtBQUNILFdBQU8sS0FBS0MsU0FBTCxDQUFlLE1BQWYsRUFBdUIsU0FBdkIsQ0FBUDtBQUNILEdBUDhCO0FBUy9CQyxFQUFBQSxPQVQrQixxQkFTckI7QUFDTixXQUFPLEtBQUtDLE9BQUwsQ0FBYSxhQUFiLEVBQTRCLFVBQTVCLENBQVA7QUFDSCxHQVg4QjtBQWF6QkMsRUFBQUEsTUFieUI7QUFBQTtBQUFBO0FBQUEsa0RBYWxCQyxJQWJrQjtB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QUFWLENBeENaOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBOztBQUFBO0FBQUE7QUFBQTs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsbURBMENjUyxFQTFDZDtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEscUJBNEM2QixJQUFJLElBQUosQ0FBUztBQUFDQSxnQkFBQUEsRUFBRSxFQUFGQTtBQUFELGVBQVQsRUFBZWhCLE9BQWYsQ0FBdUI7QUFBQ3dCLGdCQUFBQSxPQUFPLEVBQUU7QUFBVixlQUF2QixDQTVDN0I7O0FBQUE7QUE0Q2F4QixjQUFBQSxPQTVDYjtBQUFBO0FBQUE7O0FBQUE7QUFBQTtBQUFBO0FBQUEsZ0RBOENnQixLQTlDaEI7O0FBQUE7QUFBQSxnREFnRFksSUFoRFo7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7O0FBQUE7QUFBQTtBQUFBOztBQUFBO0FBQUE7QUFBQSxDQXZCUyxDQUFaOztBQTJFQXlCLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQjdDLHNCQUFVOEMsS0FBVixDQUFnQixPQUFoQixFQUF5Qi9DLEtBQXpCLENBQWpCIiwic291cmNlUm9vdCI6Ii9ob21lL2Vyd2FuL0Rlc2t0b3AvRVROQS9NT0JJL21vYmlfYXBwbGkvQVBJL3NyYy9tb2RlbHMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgXyAgICAgICAgICAgZnJvbSAnbG9kYXNoJztcbmltcG9ydCBVc2VyICAgICAgICBmcm9tICcuL3VzZXInO1xuaW1wb3J0IEdyb3VwTWVtYmVyIGZyb20gJy4vZ3JvdXBNZW1iZXInO1xuaW1wb3J0IEJvb2tzaGVsZiAgIGZyb20gJy4uL2NvbmZpZy9ib29rc2hlbGYnO1xuaW1wb3J0IGVycm9ycyAgICAgIGZyb20gJy4uL2hlbHBlcnMvZXJyb3JzJztcbmltcG9ydCBmbXQgICAgICAgICBmcm9tICcuLi9oZWxwZXJzL2Zvcm1hdHRlcnMnO1xuXG52YXIgR3JvdXAgPSBCb29rc2hlbGYuTW9kZWwuZXh0ZW5kKHtcbiAgICB0YWJsZU5hbWU6ICdncm91cHMnLFxuICAgIGlkQXR0cmlidXRlOiAnaWQnLFxuICAgIGhpZGRlbjogW10sXG5cbiAgICB1c2VyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5iZWxvbmdzVG8oJ1VzZXInLCAndXNlcl9pZCcpO1xuICAgIH0sXG5cbiAgICBtZW1iZXJzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5oYXNNYW55KCdHcm91cE1lbWJlcicsICdncm91cF9pZCcpO1xuICAgIH0sXG5cbiAgICBhc3luYyB1cGRhdGUoYm9keSkge1xuICAgICAgICBjb25zdCByZWFsYm9keSA9IF8ucGljayhib2R5LCBbJ25hbWUnLCAnZGVzY3JpcHRpb24nLCAnZGVsZXRlZCcsICd1c2VyX2lkJ10pO1xuXG4gICAgICAgIHRoaXMuc2V0KHJlYWxib2R5KTtcbiAgICAgICAgcmV0dXJuIGF3YWl0IChhd2FpdCB0aGlzLnNhdmUoKSkuZmV0Y2goe3dpdGhSZWxhdGVkOiBbJ3VzZXInLCAndXNlci5yb2xlJywgJ21lbWJlcnMnLCAnbWVtYmVycy51c2VyJywgJ21lbWJlcnMudXNlci5yb2xlJ119KTtcbiAgICB9LFxuXG4gICAgYXN5bmMgZGVsZXRlKCkge1xuICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kZXN0cm95KCk7XG4gICAgfVxufSwge1xuICAgIGFzeW5jIGdldEFsbCgpIHtcbiAgICAgICAgY29uc3QgZ3JvdXBMaXN0ID0gYXdhaXQgdGhpcy5xdWVyeSh7fSkuZmV0Y2hBbGwoe3dpdGhSZWxhdGVkOiBbJ3VzZXInLCAndXNlci5yb2xlJywgJ21lbWJlcnMnLCAnbWVtYmVycy51c2VyJywgJ21lbWJlcnMudXNlci5yb2xlJ119KTtcblxuICAgICAgICByZXR1cm4gZ3JvdXBMaXN0XG4gICAgICAgICAgICAubWFwKGdyb3VwID0+IGdyb3VwLnRvSlNPTigpKVxuICAgICAgICAgICAgLm1hcChmbXQuZ3JvdXApO1xuICAgIH0sXG5cbiAgICBhc3luYyBnZXRCeVVzZXIodXNlcl9pZCkgeyAvLyB0aGVyZSBtdXN0IGJlIGEgY2xlYW5lciB3YXkgdG8gZG8gdGhhdFxuICAgICAgICBjb25zdCByYXdSZXN1bHQgPSBhd2FpdCBCb29rc2hlbGYua25leC5yYXcoXG4gICAgICAgICAgICBgU0VMRUNUIGdyb3Vwcy5pZCBGUk9NIGdyb3VwcyBMRUZUIEpPSU4gZ3JvdXBfbWVtYmVycyBPTiBncm91cF9tZW1iZXJzLmdyb3VwX2lkID0gZ3JvdXBzLmlkICBXSEVSRSBncm91cHMudXNlcl9pZCA9ID8gT1IgZ3JvdXBfbWVtYmVycy51c2VyX2lkID0gP2AsXG4gICAgICAgICAgICBbdXNlcl9pZCwgdXNlcl9pZF1cbiAgICAgICAgKTtcbiAgICAgICAgY29uc3QgdXNlckdyb3Vwc0lkcyA9IHJhd1Jlc3VsdFswXS5tYXAobyA9PiBvLmlkKTtcbiAgICAgICAgY29uc3QgZ3JvdXBzID0gYXdhaXQgdGhpc1xuICAgICAgICAgICAgICAud2hlcmUoJ2lkJywgJ2luJywgdXNlckdyb3Vwc0lkcylcbiAgICAgICAgICAgICAgLmZldGNoQWxsKHt3aXRoUmVsYXRlZDogWyd1c2VyJywgJ3VzZXIucm9sZScsICdtZW1iZXJzJywgJ21lbWJlcnMudXNlcicsICdtZW1iZXJzLnVzZXIucm9sZSddfSk7XG5cbiAgICAgICAgcmV0dXJuIGdyb3Vwc1xuICAgICAgICAgICAgLm1hcChncm91cCA9PiBncm91cC50b0pTT04oKSlcbiAgICAgICAgICAgIC5tYXAoZm10Lmdyb3VwKTtcblxuICAgIH0sXG5cbiAgICBhc3luYyBnZXRCeUlkKGlkKSB7XG4gICAgICAgIGNvbnN0IGdyb3VwID0gIGF3YWl0IHRoaXMud2hlcmUoe2lkfSkuZmV0Y2goe3dpdGhSZWxhdGVkOiBbJ3VzZXInLCAndXNlci5yb2xlJywgJ21lbWJlcnMnLCAnbWVtYmVycy51c2VyJywgJ21lbWJlcnMudXNlci5yb2xlJ119KTtcblxuICAgICAgICBpZiAoZ3JvdXAgPT0gbnVsbCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IGVycm9ycy5HUk9VUF9OT1RfRk9VTkQoKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmbXQuZ3JvdXAoZ3JvdXAudG9KU09OKCkpO1xuICAgIH0sXG4gICAgYXN5bmMgY3JlYXRlKGJvZHkpIHtcbiAgICAgICAgY29uc3QgcmVhbGJvZHkgPSBfLnBpY2soYm9keSwgWyduYW1lJywgJ2Rlc2NyaXB0aW9uJywgJ3VzZXJfaWQnXSk7XG4gICAgICAgIGNvbnN0IGUgPSAoYXdhaXQgbmV3IHRoaXMocmVhbGJvZHkpLnNhdmUoKSkudG9KU09OKCk7XG4gICAgICAgIGNvbnN0IGdyb3VwID0gYXdhaXQgdGhpcy53aGVyZSh7aWQ6IGUuaWR9KS5mZXRjaCh7d2l0aFJlbGF0ZWQ6IFsndXNlcicsICd1c2VyLnJvbGUnLCAnbWVtYmVycycsICdtZW1iZXJzLnVzZXInLCAnbWVtYmVycy51c2VyLnJvbGUnXX0pO1xuXG4gICAgICAgIHJldHVybiBmbXQuZ3JvdXAoZ3JvdXAudG9KU09OKCkpO1xuICAgIH0sXG4gICAgYXN5bmMgZGVsZXRlKGlkKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgZGVzdHJveSA9IGF3YWl0IG5ldyB0aGlzKHtpZH0pLmRlc3Ryb3koe3JlcXVpcmU6IHRydWV9KTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IEJvb2tzaGVsZi5tb2RlbCgnR3JvdXAnLCBHcm91cCk7XG4iXX0=