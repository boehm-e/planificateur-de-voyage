{"version":3,"sources":["app.js"],"names":["port","process","env","PORT","server","http","createServer","app","logger","use","swaggerDocument","YAML","load","path","join","__dirname","swaggerUi","serve","setup","usersRoutes","rolesRoutes","authRoutes","groupsRoutes","eventsRoutes","get","_req","res","json","success","module","parent","listen","_","info","exports"],"mappings":";;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAEA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAEA,IAAMA,IAAI,GAAMC,OAAO,CAACC,GAAR,CAAYC,IAAZ,IAAoB,IAApC;;AACA,IAAMC,MAAM,GAAGC,iBAAKC,YAAL,CAAkBC,sBAAlB,CAAf,C,CAEA;;;AACA,IAAMC,MAAM,GAAI,uBAAhB;;AACAD,uBAAIE,GAAJ,CAAQ,oCAAR,E,CAEA;;;AACA,IAAMC,eAAe,GAAGC,mBAAKC,IAAL,CAAUC,iBAAKC,IAAL,CAAUC,SAAV,EAAqB,IAArB,EAA2B,SAA3B,CAAV,CAAxB;;AACAR,uBAAIE,GAAJ,CAAQ,CAAC,gBAAD,EAAmB,MAAnB,CAAR,EAAoCO,6BAAUC,KAA9C,EAAqDD,6BAAUE,KAAV,CAAgBR,eAAhB,CAArD;;AAGAH,uBAAIE,GAAJ,CAAQ,QAAR,EAAkBU,iBAAlB;;AACAZ,uBAAIE,GAAJ,CAAQ,QAAR,EAAkBW,iBAAlB;;AACAb,uBAAIE,GAAJ,CAAQ,OAAR,EAAiBY,gBAAjB;;AACAd,uBAAIE,GAAJ,CAAQ,SAAR,EAAmBa,kBAAnB;;AACAf,uBAAIE,GAAJ,CAAQ,SAAR,EAAmBc,kBAAnB;;AAGAhB,uBAAIiB,GAAJ,CAAQ,eAAR,EAAyB,UAACC,IAAD,EAAOC,GAAP,EAAe;AACpCA,EAAAA,GAAG,CAACC,IAAJ,CAAS;AAACC,IAAAA,OAAO,EAAE;AAAV,GAAT;AACH,CAFD;;AAIA,IAAI,CAACC,MAAM,CAACC,MAAZ,EAAmB;AAAE;AACjB1B,EAAAA,MAAM,CAAC2B,MAAP,CAAc/B,IAAd,EAAoB,UAAAgC,CAAC;AAAA,WAAIxB,MAAM,CAACyB,IAAP,oCAAwCjC,IAAxC,EAAJ;AAAA,GAArB;AACH;;AACD6B,MAAM,CAACK,OAAP,GAAiB3B,sBAAjB","sourceRoot":"/home/erwan/Desktop/ETNA/MOBI/mobi_appli/API/src","sourcesContent":["import path         from 'path';\nimport http         from 'http';\nimport pino         from 'pino';\nimport pinoExpress  from 'express-pino-logger';\nimport swaggerUi    from 'swagger-ui-express';\nimport YAML         from 'yamljs';\n\nimport app          from './config/express-app';\nimport usersRoutes  from './routes/users';\nimport rolesRoutes  from './routes/roles';\nimport authRoutes   from './routes/auth';\nimport groupsRoutes from './routes/groups';\nimport eventsRoutes from './routes/events';\n\nconst port   \t= process.env.PORT || 3000;\nconst server\t= http.createServer(app);\n\n// setup pino logger\nconst logger  = pino();\napp.use(pinoExpress());\n\n// api documentation\nconst swaggerDocument = YAML.load(path.join(__dirname, '..', 'doc.yml'));\napp.use(['/documentation', '/doc'], swaggerUi.serve, swaggerUi.setup(swaggerDocument));\n\n\napp.use('/users', usersRoutes);\napp.use('/roles', rolesRoutes);\napp.use('/auth', authRoutes);\napp.use('/groups', groupsRoutes);\napp.use('/events', eventsRoutes);\n\n\napp.get('/health-check', (_req, res) => {\n    res.json({success: true});\n});\n\nif (!module.parent){ // http://www.marcusoft.net/2015/10/eaddrinuse-when-watching-tests-with-mocha-and-supertest.html\n    server.listen(port, _ => logger.info(`server listening on port ${port}`));\n}\nmodule.exports = app;\n"]}